package Ocsinventory::Agent::Backend::OS::Linux::Mem;
use strict;

sub check { 	
	`which sysctl 2>&1`;
	return 0 if($? >> 8);
	`which swapctl 2>&1`;
	return 0 if($? >> 8);
	1;
};

sub run {
  my $params = shift;
  my $inventory = $params->{inventory};
  my $unit = 1024;

  my $PhysicalMemory;
  my $SwapFileSize;

	my @bsd_swapctl= `env LANGUAGE=us $bsd_swapctl_path -sk`;
	for(@bsd_swapctl){
		$SwapFileSize=$1 if /total:\s*(\d+)/i;
	}
	
	chomp($PhysicalMemory=`$bsd_sysctl_path -n hw.physmem`);
	
  $inventory->setHardware({

      MEMORY =>  sprintf("%i",$PhysicalMemory/$unit),
      SWAP =>    sprintf("%i", $SwapFileSize/$unit),

    });
}

1
